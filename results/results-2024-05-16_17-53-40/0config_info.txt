from datetime import datetime, timedelta
import math

#Number of constructed solutions 
num_of_constructions = 20  #OBS: Bør ikke settes til over 5, for er usikkert hvro mye prosessoren tåler

# Iterations in ALNS
iterations = 100

#Number of paralell processes 
num_of_paralell_iterations = 10

#Boolean for paralell 
doParalellLocalSearch = True
doParalellDestroyRepair = True

#Insertor choises [0,1,2, 3, 4] for [simple, better with max reg1, better with max regret2, better, best ]
construction_insertor = 1 #W
repair_insertor = 1
illegal_repair_insertor = 2

max_num_regret1 = 60
max_num_regret2 = 80

#Insertor som kan brukes en andel av gangene 
fraction_repair_insertor = 2
frequecy_of_fraction_insertion = 0.05
modNum_for_fraction_insertion = math.ceil(iterations*frequecy_of_fraction_insertion) 

# Requirement for how good a candidate must be before doing the local search. -- TODO: these must be tuned
local_search_req_default = 0.1

# Adaptive Weights: Brukes i ALNS for å telle når man skal oppdatere vekter på operatorer
reaction_factor_default = 0.5

# Weight score for Acceptance Criterion and giving weights [better, not better but accepted, not better, global best]. Må se på hva disse tallene skal være 
weight_score_best_default = 15
weight_score_better_default = 10
weight_score_accepted_default = 5
weight_score_bad = 0

# Iterations between each weight update in ALNS
iterations_update_default = 0.1

# k-repair value
k = 3

#The amount of activities to remove in destroy operators
destruction_degree_high_default = 0.3
destruction_degree_low_default = 0.15

# Simulated annealing temperatures -- TODO: these must be tuned
#start_temperature = 60
#end_temperature = 10
#cooling_rate = 0.96

deviation_from_best = 0.05
prob_of_choosing = 0.5 
rate_T_start_end = 0.2 

# Distance Matrix
# Buses in Oslo om average drive in 25 kms/h.
speed = 40
rush_factor = 2

# Penalty in first objective for infeasible solution
# TODO: these must be tuned
penalty_patient = 20        # Penalty per illegal patient (Not allocated patient from the pre-allocated patient list)
penalty_treat = 10          # Penalty per illegal treatment
penalty_visit = 5           # Penalty per illegal visit  
penalty_act = 3             # Penalty per illegal activity 

# Weights for objectives
weight_DW = 1             # Balance daily workload
weight_WW = 1             # Balance weekly workload
weight_S = 1/3              # Min skill difference
weight_SG = 1             # Balance specialist/generalist

#Planning period
days = 5

#Depot
depot = (59.9365, 10.7396)





ALNS iteration 2 is new global best, objective [62, 73, -24, 856]
ALNS iteration 10 is new global best, objective [62, 69, -21, 979]
ALNS iteration 77 is new global best, objective [63, 80, -27, 1063]
ALNS iteration 78 is new global best, objective [63, 78, -24, 1124]
ALNS iteration 93 is new global best, objective [59, 70, -21, 992]
ALNS iteration 94 is new global best, objective [62, 66, -25, 889]
ALNS iteration 95 is new global best, objective [66, 81, -24, 955]
ALNS iteration 96 is new global best, objective [67, 70, -24, 996]
ALNS iteration 29 is new global best, objective [57, 60, -15, 934]
ALNS iteration 42 is new global best, objective [60, 64, -23, 966]
ALNS iteration 13 is new global best, objective [55, 66, -27, 735]
ALNS iteration 14 is new global best, objective [62, 69, -20, 737]
ALNS iteration 15 is new global best, objective [64, 79, -21, 866]
ALNS iteration 1 is new global best, objective [58, 59, -14, 951]
ALNS iteration 5 is new global best, objective [59, 67, -15, 1112]
ALNS iteration 30 is new global best, objective [63, 64, -18, 917]
ALNS iteration 44 is new global best, objective [64, 74, -19, 978]
ALNS iteration 37 is new global best, objective [57, 65, -22, 945]
ALNS iteration 64 is new global best, objective [59, 52, -25, 912]
ALNS iteration 65 is new global best, objective [63, 63, -26, 1011]
ALNS iteration 66 is new global best, objective [65, 67, -27, 1078]
ALNS iteration 2 is new global best, objective [60, 64, -19, 1169]
ALNS iteration 25 is new global best, objective [61, 76, -20, 1137]
ALNS iteration 55 is new global best, objective [62, 71, -24, 1208]
ALNS iteration 56 is new global best, objective [65, 66, -23, 1106]
ALNS iteration 77 is new global best, objective [67, 74, -23, 1054]
ALNS iteration 100 is new global best, objective [69, 76, -27, 929]
ALNS iteration 1 is new global best, objective [56, 73, -21, 1117]
ALNS iteration 3 is new global best, objective [57, 64, -21, 1101]
ALNS iteration 4 is new global best, objective [59, 72, -22, 1183]
ALNS iteration 58 is new global best, objective [63, 65, -31, 917]
ALNS iteration 76 is new global best, objective [63, 63, -22, 1019]
ALNS iteration 1 is new global best, objective [60, 63, -20, 1134]
ALNS iteration 54 is new global best, objective [61, 58, -21, 906]
ALNS iteration 55 is new global best, objective [65, 71, -22, 961]
ALNS iteration 2 is new global best, objective [64, 78, -17, 1111]
ALNS iteration 1 is new global best, objective [58, 63, -17, 1023]
ALNS iteration 10 is new global best, objective [60, 67, -29, 987]
ALNS iteration 38 is new global best, objective [61, 62, -25, 1004]
ALNS iteration 50 is new global best, objective [62, 70, -20, 950]
ALNS iteration 52 is new global best, objective [64, 74, -32, 977]
ALNS iteration 2 is new global best, objective [57, 69, -19, 1120]
ALNS iteration 3 is new global best, objective [60, 67, -18, 1036]
ALNS iteration 5 is new global best, objective [64, 74, -22, 1212]
ALNS iteration 54 is new global best, objective [68, 70, -29, 1044]
ALNS iteration 20 is new global best, objective [59, 70, -19, 1008]
ALNS iteration 21 is new global best, objective [62, 65, -28, 916]
ALNS iteration 66 is new global best, objective [63, 61, -20, 1054]
ALNS iteration 67 is new global best, objective [65, 68, -24, 1024]
ALNS iteration 1 is new global best, objective [60, 64, -22, 1005]
ALNS iteration 19 is new global best, objective [65, 68, -30, 877]
ALNS iteration 1 is new global best, objective [58, 65, -23, 1004]
ALNS iteration 25 is new global best, objective [59, 75, -23, 908]
ALNS iteration 33 is new global best, objective [64, 68, -24, 959]
ALNS iteration 7 is new global best, objective [59, 72, -25, 1064]
ALNS iteration 10 is new global best, objective [60, 63, -19, 943]
ALNS iteration 78 is new global best, objective [65, 71, -30, 1020]
ALNS iteration 4 is new global best, objective [58, 80, -22, 1076]
ALNS iteration 25 is new global best, objective [62, 71, -22, 1118]
ALNS iteration 5 is new global best, objective [60, 65, -26, 1021]
ALNS iteration 30 is new global best, objective [62, 70, -20, 1075]
ALNS iteration 5 is new global best, objective [59, 68, -25, 890]
ALNS iteration 10 is new global best, objective [63, 66, -21, 963]
ALNS iteration 70 is new global best, objective [65, 70, -26, 1139]
ALNS iteration 11 is new global best, objective [62, 71, -20, 1071]
ALNS iteration 67 is new global best, objective [64, 78, -26, 1077]
ALNS iteration 2 is new global best, objective [57, 69, -23, 898]
ALNS iteration 32 is new global best, objective [57, 66, -15, 846]
ALNS iteration 39 is new global best, objective [59, 72, -28, 961]
ALNS iteration 40 is new global best, objective [64, 76, -28, 1036]
ALNS iteration 2 is new global best, objective [55, 61, -24, 929]
ALNS iteration 17 is new global best, objective [57, 70, -17, 803]
ALNS iteration 19 is new global best, objective [57, 65, -14, 923]
ALNS iteration 23 is new global best, objective [59, 69, -21, 986]
ALNS iteration 26 is new global best, objective [63, 59, -26, 1098]
ALNS iteration 27 is new global best, objective [65, 68, -22, 977]
ALNS iteration 18 is new global best, objective [58, 61, -27, 970]
ALNS iteration 19 is new global best, objective [62, 60, -26, 922]
ALNS iteration 59 is new global best, objective [63, 64, -20, 1040]
ALNS iteration 71 is new global best, objective [65, 73, -28, 809]
