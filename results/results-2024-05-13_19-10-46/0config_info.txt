from datetime import datetime, timedelta
import math

#Number of constructed solutions 
num_of_constructions = 20  #OBS: Bør ikke settes til over 5, for er usikkert hvro mye prosessoren tåler

# Iterations in ALNS
iterations = 100

#Number of paralell processes 
num_of_paralell_iterations = 10

#Boolean for paralell 
doParalellLocalSearch = True
doParalellDestroyRepair = True

#Insertor choises [0,1,2, 3, 4] for [simple, better with max reg1, better with max regret2, better, best ]
construction_insertor = 1 #W
repair_insertor = 1
illegal_repair_insertor = 2

max_num_regret1 = 60
max_num_regret2 = 80

#Insertor som kan brukes en andel av gangene 
fraction_repair_insertor = 2
frequecy_of_fraction_insertion = 0.05
modNum_for_fraction_insertion = math.ceil(iterations*frequecy_of_fraction_insertion) 

# Requirement for how good a candidate must be before doing the local search. -- TODO: these must be tuned
local_search_req_default = 0.02

# Adaptive Weights: Brukes i ALNS for å telle når man skal oppdatere vekter på operatorer
reaction_factor_default = 0.7

# Weight score for Acceptance Criterion and giving weights [better, not better but accepted, not better, global best]. Må se på hva disse tallene skal være 
weight_score_best_default = 15
weight_score_better_default = 10
weight_score_accepted_default = 5
weight_score_bad = 0

# Iterations between each weight update in ALNS
iterations_update_default = 0.1

# k-repair value
k = 3

#The amount of activities to remove in destroy operators
destruction_degree_high_default = 0.3
destruction_degree_low_default = 0.15

# Simulated annealing temperatures -- TODO: these must be tuned
#start_temperature = 60
#end_temperature = 10
#cooling_rate = 0.96

deviation_from_best = 0.05
prob_of_choosing = 0.5 
rate_T_start_end = 0.2 

# Distance Matrix
# Buses in Oslo om average drive in 25 kms/h.
speed = 40
rush_factor = 2

# Penalty in first objective for infeasible solution
# TODO: these must be tuned
penalty_patient = 20        # Penalty per illegal patient (Not allocated patient from the pre-allocated patient list)
penalty_treat = 10          # Penalty per illegal treatment
penalty_visit = 5           # Penalty per illegal visit  
penalty_act = 3             # Penalty per illegal activity 

# Weights for objectives
weight_DW = 1             # Balance daily workload
weight_WW = 1             # Balance weekly workload
weight_S = 1/3              # Min skill difference
weight_SG = 1             # Balance specialist/generalist

#Planning period
days = 5

#Depot
depot = (59.9365, 10.7396)





ALNS iteration 5 is new global best, objective [86, 75, -21, 952]
ALNS iteration 6 is new global best, objective [86, 74, -21, 989]
ALNS iteration 7 is new global best, objective [86, 66, -29, 840]
ALNS iteration 75 is new global best, objective [86, 64, -31, 777]
ALNS iteration 3 is new global best, objective [88, 74, -20, 927]
ALNS iteration 4 is new global best, objective [91, 78, -25, 934]
ALNS iteration 6 is new global best, objective [91, 77, -29, 898]
ALNS iteration 18 is new global best, objective [91, 76, -27, 944]
ALNS iteration 5 is new global best, objective [88, 82, -18, 872]
ALNS iteration 6 is new global best, objective [91, 88, -21, 891]
ALNS iteration 10 is new global best, objective [91, 86, -21, 1045]
ALNS iteration 20 is new global best, objective [91, 84, -21, 1024]
ALNS iteration 73 is new global best, objective [91, 80, -23, 869]
ALNS iteration 10 is new global best, objective [91, 83, -31, 914]
ALNS iteration 13 is new global best, objective [91, 75, -31, 1002]
ALNS iteration 25 is new global best, objective [91, 72, -29, 964]
ALNS iteration 3 is new global best, objective [91, 84, -27, 1012]
ALNS iteration 1 is new global best, objective [88, 76, -24, 885]
ALNS iteration 6 is new global best, objective [88, 76, -24, 869]
ALNS iteration 15 is new global best, objective [91, 82, -23, 934]
ALNS iteration 16 is new global best, objective [91, 75, -25, 912]
ALNS iteration 25 is new global best, objective [91, 74, -21, 964]
ALNS iteration 2 is new global best, objective [86, 76, -25, 943]
ALNS iteration 3 is new global best, objective [91, 80, -25, 1053]
ALNS iteration 12 is new global best, objective [91, 72, -27, 958]
ALNS iteration 2 is new global best, objective [88, 69, -20, 867]
ALNS iteration 10 is new global best, objective [91, 79, -27, 916]
ALNS iteration 35 is new global best, objective [91, 76, -25, 833]
ALNS iteration 38 is new global best, objective [91, 75, -27, 964]
ALNS iteration 4 is new global best, objective [88, 76, -18, 893]
ALNS iteration 8 is new global best, objective [91, 76, -27, 970]
ALNS iteration 67 is new global best, objective [91, 74, -27, 1012]
ALNS iteration 2 is new global best, objective [91, 76, -25, 958]
ALNS iteration 32 is new global best, objective [91, 75, -31, 1034]
ALNS iteration 80 is new global best, objective [91, 73, -25, 959]
ALNS iteration 1 is new global best, objective [86, 78, -21, 888]
ALNS iteration 5 is new global best, objective [86, 77, -23, 789]
ALNS iteration 7 is new global best, objective [86, 74, -23, 884]
ALNS iteration 9 is new global best, objective [86, 72, -25, 902]
ALNS iteration 10 is new global best, objective [86, 72, -27, 913]
ALNS iteration 19 is new global best, objective [86, 72, -27, 826]
ALNS iteration 21 is new global best, objective [86, 68, -31, 859]
ALNS iteration 37 is new global best, objective [86, 67, -29, 871]
ALNS iteration 43 is new global best, objective [86, 67, -29, 818]
ALNS iteration 1 is new global best, objective [88, 81, -20, 893]
ALNS iteration 5 is new global best, objective [91, 84, -25, 963]
ALNS iteration 37 is new global best, objective [91, 77, -25, 949]
ALNS iteration 8 is new global best, objective [86, 78, -27, 998]
ALNS iteration 32 is new global best, objective [86, 72, -31, 846]
ALNS iteration 33 is new global best, objective [86, 71, -25, 815]
ALNS iteration 35 is new global best, objective [86, 68, -25, 769]
ALNS iteration 3 is new global best, objective [86, 72, -21, 901]
ALNS iteration 5 is new global best, objective [91, 77, -23, 938]
ALNS iteration 1 is new global best, objective [91, 85, -19, 1080]
ALNS iteration 2 is new global best, objective [91, 83, -21, 1048]
ALNS iteration 8 is new global best, objective [91, 82, -21, 1104]
ALNS iteration 12 is new global best, objective [91, 80, -19, 1107]
ALNS iteration 27 is new global best, objective [91, 80, -23, 1141]
ALNS iteration 31 is new global best, objective [91, 78, -23, 1122]
ALNS iteration 32 is new global best, objective [91, 78, -23, 1112]
ALNS iteration 61 is new global best, objective [91, 78, -25, 1018]
ALNS iteration 62 is new global best, objective [91, 78, -25, 1005]
ALNS iteration 75 is new global best, objective [91, 75, -21, 883]
ALNS iteration 81 is new global best, objective [91, 74, -21, 899]
ALNS iteration 82 is new global best, objective [91, 73, -19, 880]
ALNS iteration 100 is new global best, objective [91, 71, -21, 880]
ALNS iteration 3 is new global best, objective [91, 77, -27, 950]
ALNS iteration 6 is new global best, objective [91, 74, -23, 1001]
ALNS iteration 33 is new global best, objective [91, 73, -21, 1003]
ALNS iteration 4 is new global best, objective [91, 80, -23, 984]
ALNS iteration 3 is new global best, objective [88, 75, -24, 887]
ALNS iteration 5 is new global best, objective [91, 77, -27, 945]
ALNS iteration 72 is new global best, objective [91, 75, -29, 946]
ALNS iteration 4 is new global best, objective [88, 72, -26, 969]
ALNS iteration 10 is new global best, objective [91, 81, -31, 987]
ALNS iteration 23 is new global best, objective [91, 80, -27, 989]
ALNS iteration 34 is new global best, objective [91, 79, -29, 891]
ALNS iteration 74 is new global best, objective [91, 76, -21, 887]
